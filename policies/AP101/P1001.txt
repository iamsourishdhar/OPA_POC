package mydb.policy

import data.mydb.dbaccess
import input

default allow = false
default	exist =false

allow {
      some i
      dbaccess.associates[i].name==input.name
	  associate:=dbaccess.associates[i]
	  some j
	  dbaccess.roles[j].RoleName==input.role
	  role:=dbaccess.roles[j]
	  some k
	  dbaccess.environments[k].envName==input.env
	  environment:=dbaccess.environments[k]
	  
	  some l,m
	  dbaccess.useraccess[l].id==associate.id
	  dbaccess.useraccess[l].envAccess[m].env==environment.envId
	  dbaccess.useraccess[l].envAccess[m].roles[_]==role.roleId
	  
}

exist {
	validateAssociate(input.name)
}



validateAssociate(x){
	 dbaccess.associates[_].name==x
}


showAll[result]{
	result:=dbaccess.associates[_]
}
